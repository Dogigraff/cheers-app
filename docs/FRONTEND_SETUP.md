# Frontend Setup - Map & Beacons

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. –•—É–∫ `useNearbyBeacons`

**–§–∞–π–ª:** `hooks/use-nearby-beacons.ts`

React —Ö—É–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –±–ª–∏–∂–∞–π—à–∏—Ö –º–∞—è–∫–æ–≤ —á–µ—Ä–µ–∑ RPC —Ñ—É–Ω–∫—Ü–∏—é.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `beacons` - –º–∞—Å—Å–∏–≤ –±–ª–∏–∂–∞–π—à–∏—Ö –º–∞—è–∫–æ–≤
- `loading` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
- `error` - –æ—à–∏–±–∫–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
- `userLocation` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `{lat, long}`
- `refetch` - —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ü—Ä–∏ –æ—Ç–∫–∞–∑–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –ú–æ—Å–∫–≤—ã (55.76, 37.59) –¥–ª—è –¥–µ–º–æ
- –ö—ç—à–∏—Ä—É–µ—Ç –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é –Ω–∞ 1 –º–∏–Ω—É—Ç—É

### 2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç—ã `MapView`

**–§–∞–π–ª:** `components/map/map-view.tsx`

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å —ç–º–æ–¥–∑–∏-–º–∞—Ä–∫–µ—Ä–∞–º–∏ –¥–ª—è –º–∞—è–∫–æ–≤.

**–§—É–Ω–∫—Ü–∏–∏:**
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –º–∞—è–∫–∏ —Å —ç–º–æ–¥–∑–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –Ω–∞–ø–∏—Ç–∫–∞:
  - üç∑ - –≤–∏–Ω–æ (wine)
  - ü•É - –≤–∏—Å–∫–∏ (whiskey)
  - üç∫ - –ø–∏–≤–æ (beer)
  - üç∏ - –≤–æ–¥–∫–∞ (vodka)
  - üî• - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –º–∞—Ä–∫–µ—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Sheet (Drawer) —Å–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ –º–∞—è–∫–∞: –∞–≤–∞—Ç–∞—Ä, –∏–º—è, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, —Ç–∏–ø –Ω–∞–ø–∏—Ç–∫–∞
- –ö–Ω–æ–ø–∫–∞ "Join Party" –¥–ª—è –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ –≤–µ—á–µ—Ä–∏–Ω–∫–µ

**–°—Ç–∏–ª–∏–∑–∞—Ü–∏—è:**
- –≠–º–æ–¥–∑–∏-–∏–∫–æ–Ω–∫–∏ —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º —Å–≤–µ—á–µ–Ω–∏—è (glow)
- –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ –∫–∞—Ä—Ç—ã
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### 3. –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

**–§–∞–π–ª:** `app/page.tsx`

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –¥–ª—è `MapView` (–∏–∑–±–µ–≥–∞–µ—Ç SSR –ø—Ä–æ–±–ª–µ–º —Å Leaflet).

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```typescript
import { useNearbyBeacons } from "@/hooks/use-nearby-beacons";

function MyComponent() {
  const { beacons, loading, error, userLocation } = useNearbyBeacons(5000);
  
  if (loading) return <div>Loading...</div>;
  if (error) return <div>Error: {error}</div>;
  
  return (
    <div>
      {beacons.map(beacon => (
        <div key={beacon.id}>{beacon.username}</div>
      ))}
    </div>
  );
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã

```typescript
import { MapView } from "@/components/map/map-view";

export default function Page() {
  return <MapView />;
}
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –º–∞—è–∫–∞

```typescript
interface NearbyBeacon {
  id: string;
  user_id: string;
  location: unknown; // PostGIS GEOGRAPHY
  beacon_lat: number; // –®–∏—Ä–æ—Ç–∞
  beacon_lng: number; // –î–æ–ª–≥–æ—Ç–∞
  mood: string | null;
  assets: {
    type?: string; // 'wine', 'whiskey', 'beer', 'vodka'
    brand?: string;
  } | null;
  expires_at: string;
  is_active: boolean | null;
  created_at: string | null;
  username: string | null;
  avatar_url: string | null;
  reputation: number | null;
}
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `react-leaflet` - React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è Leaflet
- `leaflet` - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–∞—Ä—Ç
- `@radix-ui/react-dialog` - –î–ª—è Sheet –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- `lucide-react` - –ò–∫–æ–Ω–∫–∏

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É "Join Party" (—Å–æ–∑–¥–∞–Ω–∏–µ interaction/match)
2. –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ —Ç–∏–ø—É –Ω–∞–ø–∏—Ç–∫–∞
3. –î–æ–±–∞–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—è–∫–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (Supabase Realtime)
4. –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –º–∞—è–∫–æ–≤
