# Миграция на Яндекс.Карты

## Что было сделано

✅ Удалены зависимости: `react-leaflet`, `leaflet`
✅ Установлена библиотека: `@pbe/react-yandex-maps`
✅ Рефакторен компонент `components/map/map-view.tsx`
✅ Добавлена темная тема через CSS фильтры
✅ Сохранена вся функциональность (эмодзи-маркеры, Sheet при клике)

## Изменения в коде

### Компонент карты

- Заменен `MapContainer` из Leaflet на `<YMaps><Map>` из Яндекс.Карт
- Используется `Placemark` для отображения маяков
- Эмодзи отображаются через `iconContent` в свойствах Placemark
- Сохранена логика открытия Sheet при клике на маркер

### Темная тема

Добавлены CSS стили в `app/globals.css`:

```css
/* Делаем Яндекс Карту темной */
.yandex-map-dark canvas {
  filter: grayscale(1) invert(1) contrast(1.2) !important;
}

/* Возвращаем цветам эмодзи нормальный вид */
.ymaps-2-1-79-image-with-content-content {
  filter: invert(1) !important;
  /* + стили для красивого отображения эмодзи */
}
```

## API Ключ Яндекс.Карт

Для локальной разработки Яндекс.Карты часто работают без ключа.

Для продакшена:
1. Получите ключ в [Кабинете Разработчика Яндекс](https://developer.tech.yandex.ru/)
2. Добавьте в `.env.local`:
   ```
   NEXT_PUBLIC_YANDEX_MAPS_API_KEY=ваш_ключ
   ```

## Преимущества Яндекс.Карт

- ✅ Лучшая поддержка для России и СНГ
- ✅ Более точные карты для Москвы
- ✅ Лучшая производительность в регионе
- ✅ Поддержка русского языка из коробки

## Что осталось без изменений

- ✅ Хук `useNearbyBeacons` работает как прежде
- ✅ RPC функция `get_nearby_beacons` без изменений
- ✅ Sheet с деталями маяка работает идентично
- ✅ Логика геолокации не изменилась

## Отладка

Если карта не отображается:
1. Проверьте консоль браузера на ошибки
2. Убедитесь, что API ключ установлен (или оставьте пустым для dev)
3. Проверьте, что координаты маяков корректны
4. Убедитесь, что CSS фильтры применяются (проверьте класс `.yandex-map-dark`)
